@import './sap/_sap.theme.scss';
@import './base.scss';
@import './sap-animation.scss';

.page-sap {
    --header-height: var(--comp-size-3);
    --breadcrumb-height: var(--comp-size-3);
    --item-width: 250px;

    @media screen and (max-width: $screen-xs-max) {
        --item-width: 250px;
    }

    @media (min-width: $screen-sm-min) and (max-width: $screen-sm-max) {
        --item-width: 280px;
    }

    @media (min-width: $screen-md-min) and (max-width: $screen-md-max) {
        --item-width: 300px;
    }

    @media screen and (min-width: $screen-lg-min) {
        --item-width: 360px;
    }


    @include hidden-scrollbar();

    .header {
        grid-area: header;
    }

    .breadcrumb {
        z-index: #{$ui-header-index - 1};
        grid-area: breadcrumb;
    }

    .detail {
        grid-area: detail;
        overflow: hidden;

        &:empty {
            display: none;
        }
    }

    .result {
        grid-area: result;
    }

    .aside {
        grid-area: aside;
    }

    .footer {
        grid-area: footer;
    }

    display: grid;
    transition: grid-template-columns 0.5s ease-in-out;
    grid-template-columns: 1fr;

    --result-width: auto;

    @media screen and (orientation:portrait) {
        grid-template-columns: 1fr 0;
        grid-template-rows: var(--header-height) var(--breadcrumb-height) auto auto auto;
        grid-template-areas:
            "header header"
            "breadcrumb breadcrumb"
            "detail aside"
            "result aside"
            "footer aside";
    }

    @media screen and (orientation:landscape) {
        --result-width: var(--item-width);
        grid-template-columns: calc(100% - var(--result-width) - var(--g2)) var(--result-width) var(--g2);
        grid-template-rows: var(--header-height) var(--breadcrumb-height) auto auto;
        grid-template-areas:
            "header header header"
            "breadcrumb breadcrumb breadcrumb"
            "detail result aside"
            "detail footer aside";
    }

    @media (orientation:landscape) and (min-width: $screen-lg-min) {
        --result-width: calc(var(--item-width) * 2 + var(--g2));
    }

    &.view-grid {
        @media screen and (orientation:portrait) {
            grid-template-rows: var(--header-height) var(--breadcrumb-height) 0 auto auto;
        }

        @media screen and (orientation:landscape) {
            grid-template-columns: 0 100%;
            grid-template-rows: var(--header-height) var(--breadcrumb-height) auto auto;
        }

        .result {
            padding: var(--g2);
        }
    }

    &.view-detail {
        @media screen and (orientation:portrait) {
            grid-template-rows: var(--header-height) var(--breadcrumb-height) auto auto auto;

            .result {
                padding: var(--g2);
            }
        }

        @media screen and (orientation:landscape) {
            .header-close {
                transform: none;
            }

            .breadcrumb {
                position: sticky;
                top: var(--header-height);
            }

            .detail {
                position: sticky;
                top: calc(var(--header-height) + var(--breadcrumb-height));
                height: calc(100dvh - var(--header-height) - var(--breadcrumb-height));
                overflow-y: auto;
                overflow-x: hidden;
                @include hidden-scrollbar();
            }

            .result {
                padding: var(--g2) 0;
                overflow-y: auto;
                overflow-x: hidden;
            }

            .result,
            .footer {}
        }
    }

    // &.view-aside {
    //     @media screen and (orientation:portrait) {
    //         --main-size: var(--item-height);
    //         grid-template-rows: var(--header-height) var(--breadcrumb-height) auto auto auto;
    //         grid-template-columns: 1fr;
    //         grid-template-areas:
    //             "header"
    //             "breadcrumb"
    //             "detail"
    //             "result"
    //             "footer";

    //         .result {
    //             display: flex;
    //             overflow-x: auto;
    //             // backdrop-filter: blur(20px);
    //             @include scroll-smooth();
    //             padding: var(--g2);

    //             >* {
    //                 flex-shrink: 0;
    //             }
    //         }
    //     }

    //     @media screen and (orientation:landscape) {
    //         display: grid;
    //         grid-template-columns: auto minmax(400px, 20%);
    //         grid-template-rows: var(--header-height) var(--breadcrumb-height) calc(100dvh - var(--header-height) - var(--breadcrumb-height));
    //         grid-template-areas:
    //             "header header"
    //             "breadcrumb breadcrumb"
    //             "detail result";

    //         .footer {
    //             display: none;
    //         }

    //         .result {
    //             padding: var(--g2) var(--g2) var(--g2) 0;
    //             overflow-y: auto;
    //             overflow-x: hidden;
    //         }
    //     }
    // }
}

.filter {
    display: flex;
    gap: var(--g1);
    align-items: center;

    >* {
        flex-shrink: 0;
    }

    overflow-x: auto;
    @include scroll-smooth();
    @include snap();
    @include hidden-scrollbar();
}

.result {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--item-width), 1fr));
    position: relative;
    z-index: 2;
    @include hidden-scrollbar();
    gap: var(--g2);

    .item {
        cursor: pointer;
    }

    article {
        --article-gap: min(var(--g2), 3%);
        border-radius: 8px;
        box-shadow: inset 0 0 0 1px var(--color-bg-l1);
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        overflow: hidden;
        gap: var(--g2);
        padding-bottom: var(--g2);

        >figure {
            width: 100%;
            padding-top: 65%;
            height: 0;
            order: 1;
            position: relative;
            overflow: hidden;

            >figcaption {
                position: absolute;
                font-size: var(--font-size-7);
                top: 0;
                right: 0;
                z-index: 2;
                color: var(--color-bg);
                padding: var(--g0);
                background-color: rgba(0, 0, 0, 0.5);
                border-radius: 0 0 0 4px;
            }

            >img {
                height: 100%;
                width: 100%;
                position: absolute;
                top: 0;
                left: 0;
                object-fit: cover;
            }
        }

        >a {
            order: 3;
            padding: 0 var(--article-gap);

            address {
                font-size: var(--font-size-6);
                @include singleline();
            }
        }

        >ul {
            flex-shrink: 0;
            order: 2;
            padding: 0 var(--article-gap);
            font-weight: var(--font-weight-medium);
            display: flex;
            gap: var(--g2) var(--article-gap);
            align-items: baseline;
            flex-wrap: wrap;
            height: 1.2rem;
            overflow: hidden;

            >li {
                white-space: nowrap;

                b {
                    font-size: var(--font-size-4);
                    font-weight: var(--font-weight-bold);
                }

                span {
                    font-size: var(--font-size-5);
                    font-weight: var(--font-weight-medium);
                }

                abbr {
                    font-size: var(--font-size-6);
                    color: var(--color-l1)
                }
            }
        }
    }
}